<!DOCTYPE html>
<html>
<head>
  <title>Should I create a rally?</title>
  <link rel="stylesheet" href="style.css">
  <style>
    a.home-button {
      position: absolute;
      top: 20px;
      left: 20px;
      padding: 10px 15px;
      background-color: #007bff;
      color: white;
      text-decoration: none;
      border-radius: 5px;
      font-weight: bold;
    }
    table {
      border-collapse: collapse;
      margin: 20px auto;
    }
    td {
      border: 1px solid #ccc;
      padding: 15px 20px;
      min-width: 120px;
      text-align: center;
      font-weight: bold;
      background-color: #fff;
    }
  </style>
</head>
<body>
  <a href="index.html" class="home-button">Home</a>
  <h1>Should I create a rally?</h1>

  <p>If you are not one of these players; <strong>NO</strong></p>
  <table id="table1"></table>

  <p>If too many are missing; you <strong>CAN</strong> create a rally IF you are one of these players</p>
  <table id="table2"></table>

  <!-- Load Google API -->
  <script src="https://apis.google.com/js/api.js"></script>
  <script>
    const SPREADSHEET_ID = '1zhPWij4tcnLIL4XO3ajF5tMuSzUl9eBvoqcMUJrkiZ4';
    const RANGE = 'Sheet1!A:C'; // Change if needed
    const API_KEY = 'AIzaSyDep63nWFdX_ldOMVxw-lMJ6yLJGAclhw0'; // Your API Key
    
    function init() {
      gapi.client.init({
        'apiKey': API_KEY,
        'discoveryDocs': ["https://sheets.googleapis.com/$discovery/rest?version=v4"],
      }).then(() => {
        return gapi.client.sheets.spreadsheets.values.get({
          spreadsheetId: SPREADSHEET_ID,
          range: RANGE,
        });
      }).then(response => {
        const data = response.result.values.slice(1); // Skip headers
        const filtered = data.filter(row => row[0] && row[2]); // Make sure name and power exist
        const sorted = filtered.sort((a, b) => parseInt(b[2]) - parseInt(a[2]));

        const top9 = sorted.slice(0, 9);
        const next9 = sorted.slice(9, 18);

        fillGridTable('table1', top9);
        fillGridTable('table2', next9);
      }).catch(err => {
        console.error('Error loading data from Google Sheets:', err);
      });
    }

    function fillGridTable(tableId, rows) {
      const table = document.getElementById(tableId);
      for (let i = 0; i < 3; i++) {
        const tr = document.createElement('tr');
        for (let j = 0; j < 3; j++) {
          const index = i * 3 + j;
          const name = rows[index]?.[0] || '';
          const td = document.createElement('td');
          td.textContent = name;
          tr.appendChild(td);
        }
        table.appendChild(tr);
      }
    }

    gapi.load('client', init);
  </script>
</body>
</html>
